<!doctype html>
<html lang="en" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The LOOP Builder</title>
  <script src="https://cdn.tailwindcss.com/3.4.17"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;family=Source+Serif+4:wght@600;700&amp;display=swap" rel="stylesheet">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            surface: '#F8F9FA',
            card: '#FFFFFF',
            navy: '#1E3A5F',
            navyLight: '#2D4A6F',
            slate: '#64748B',
            text: '#1F2937',
            muted: '#6B7280',
            border: '#E5E7EB',
            success: '#059669',
            warning: '#D97706',
            caution: '#DC2626'
          },
          fontFamily: {
            sans: ['Inter', 'system-ui', 'sans-serif'],
            serif: ['Source Serif 4', 'Georgia', 'serif']
          }
        }
      }
    }
  </script>
  <style>
    html, body {
      height: 100%;
      margin: 0;
    }
    .feedback-card {
      transition: all 0.2s ease;
    }
    .feedback-card.selected {
      transform: scale(1.02);
    }
    .step-indicator {
      transition: all 0.3s ease;
    }
    .input-field:focus {
      outline: none;
      border-color: #1E3A5F;
      box-shadow: 0 0 0 3px rgba(30, 58, 95, 0.1);
    }
    .btn-primary {
      transition: all 0.2s ease;
    }
    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(30, 58, 95, 0.3);
    }
    .screen {
      animation: fadeIn 0.3s ease;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
  <style>body { box-sizing: border-box; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full bg-surface font-sans">
  <div id="app" class="h-full w-full overflow-auto"><!-- Header -->
   <header class="sticky top-0 bg-white border-b border-border z-10">
    <div class="max-w-2xl mx-auto px-4 py-4">
     <div class="flex items-center justify-between">
      <div>
       <h1 id="main-title" class="font-serif text-xl font-bold text-navy">The LOOP Builder</h1>
       <p id="subtitle" class="text-sm text-muted mt-0.5">Build your first working business system.</p>
      </div>
      <div class="flex items-center gap-2"><span id="step-label" class="text-sm font-medium text-slate">Step 1 of 5</span>
      </div>
     </div><!-- Progress Bar -->
     <div class="mt-4 flex gap-2">
      <div id="progress-1" class="step-indicator h-1.5 flex-1 rounded-full bg-navy"></div>
      <div id="progress-2" class="step-indicator h-1.5 flex-1 rounded-full bg-border"></div>
      <div id="progress-3" class="step-indicator h-1.5 flex-1 rounded-full bg-border"></div>
      <div id="progress-4" class="step-indicator h-1.5 flex-1 rounded-full bg-border"></div>
      <div id="progress-5" class="step-indicator h-1.5 flex-1 rounded-full bg-border"></div>
     </div>
    </div>
   </header><!-- Main Content -->
   <main class="max-w-2xl mx-auto px-4 py-6 pb-24"><!-- Screen 1: Lead Trigger -->
    <div id="screen-1" class="screen">
     <div class="mb-6">
      <div class="flex items-center gap-2 mb-2"><span class="w-8 h-8 rounded-full bg-navy text-white flex items-center justify-center text-sm font-semibold">L</span>
       <h2 class="font-serif text-2xl font-bold text-text">Define the Trigger</h2>
      </div>
      <p class="text-muted text-base leading-relaxed">What specific action starts your system?</p>
     </div><!-- Input Card -->
     <div class="bg-card rounded-xl shadow-sm border border-border p-5 mb-6">
      <div class="space-y-4">
       <div><label class="block text-sm font-medium text-text mb-1.5">Who do you serve?</label> <input type="text" id="lead-audience" class="input-field w-full px-4 py-3 border border-border rounded-lg text-text placeholder-slate" placeholder="e.g., First-time founders in B2B SaaS">
       </div>
       <div><label class="block text-sm font-medium text-text mb-1.5">What problem do they have?</label> <input type="text" id="lead-problem" class="input-field w-full px-4 py-3 border border-border rounded-lg text-text placeholder-slate" placeholder="e.g., They cannot convert interest into calls">
       </div>
       <div><label class="block text-sm font-medium text-text mb-1.5">What is your first call to action?</label> <input type="text" id="lead-cta" class="input-field w-full px-4 py-3 border border-border rounded-lg text-text placeholder-slate" placeholder="e.g., Comment 'LOOP' on my post">
       </div>
       <div><label class="block text-sm font-medium text-text mb-1.5">Primary channel</label> <select id="lead-channel" class="input-field w-full px-4 py-3 border border-border rounded-lg text-text bg-white"> <option value="">Select a channel</option> <option value="linkedin">LinkedIn</option> <option value="landing">Landing Page</option> <option value="event">Event</option> <option value="email">Email</option> <option value="other">Other</option> </select>
       </div>
      </div>
     </div><!-- Feedback Panel -->
     <div class="mb-6">
      <div class="mb-4">
       <p class="text-sm font-medium text-muted mb-3 uppercase tracking-wide">Self-Evaluation Checklist</p>
       <div class="bg-surface rounded-lg p-4 space-y-2 text-sm"><label class="flex items-start gap-2 cursor-pointer"> <input type="checkbox" id="check-1-1" class="mt-1"> <span class="text-text">Can you picture a real person in this audience?</span> </label> <label class="flex items-start gap-2 cursor-pointer"> <input type="checkbox" id="check-1-2" class="mt-1"> <span class="text-text">Is the problem observable in their daily behavior?</span> </label> <label class="flex items-start gap-2 cursor-pointer"> <input type="checkbox" id="check-1-3" class="mt-1"> <span class="text-text">Is the call to action something they can do today?</span> </label> <label class="flex items-start gap-2 cursor-pointer"> <input type="checkbox" id="check-1-4" class="mt-1"> <span class="text-text">Is the channel where this audience already spends time?</span> </label>
       </div>
      </div>
      <p class="text-sm font-medium text-muted mb-3 uppercase tracking-wide">System Evaluation</p>
      <div class="mb-4 bg-surface rounded-lg p-4">
       <div class="flex justify-between items-center mb-2">
        <p class="text-xs font-medium text-muted uppercase tracking-wide">Clarity Score</p><span id="clarity-score-1" class="text-sm font-semibold text-slate">0/4</span>
       </div>
       <div class="w-full h-2 bg-border rounded-full overflow-hidden">
        <div id="clarity-bar-1" class="h-full bg-caution transition-all duration-300" style="width: 0%"></div>
       </div>
      </div>
      <div class="grid gap-3">
       <div class="feedback-card cursor-pointer bg-card border-2 border-caution rounded-xl p-4 hover:shadow-md transition-shadow" data-feedback="1-1" onclick="selectFeedback('1-1')">
        <div class="flex items-start gap-3">
         <div class="w-3 h-3 rounded-full bg-caution mt-1 flex-shrink-0"></div>
         <div>
          <p class="font-medium text-text text-sm">Needs Focus</p>
          <p class="text-muted text-xs mt-1 leading-relaxed">Your audience definition is too broad to target. Without specificity—industry, role, stage, or behavior—you cannot predict who will respond or what they need.</p>
          <p class="text-muted text-xs mt-2 font-medium">Action: Add one or two constraints (e.g., "SaaS founders in Series A" or "Nonprofits with $2–5M budgets").</p>
         </div>
        </div>
       </div>
       <div class="feedback-card cursor-pointer bg-card border-2 border-border rounded-xl p-4 hover:shadow-md transition-shadow" data-feedback="1-2" onclick="selectFeedback('1-2')">
        <div class="flex items-start gap-3">
         <div class="w-3 h-3 rounded-full bg-warning mt-1 flex-shrink-0"></div>
         <div>
          <p class="font-medium text-text text-sm">Getting Clear</p>
          <p class="text-muted text-xs mt-1 leading-relaxed">The audience and problem are specific, but the outcome is abstract. "Learn more" or "get clarity" is not observable. Define the behavior change you expect.</p>
          <p class="text-muted text-xs mt-2 font-medium">Action: Replace outcome language with a result (e.g., "book a call" instead of "show interest").</p>
         </div>
        </div>
       </div>
       <div class="feedback-card cursor-pointer bg-card border-2 border-border rounded-xl p-4 hover:shadow-md transition-shadow" data-feedback="1-3" onclick="selectFeedback('1-3')">
        <div class="flex items-start gap-3">
         <div class="w-3 h-3 rounded-full bg-success mt-1 flex-shrink-0"></div>
         <div>
          <p class="font-medium text-text text-sm">Ready to Test</p>
          <p class="text-muted text-xs mt-1 leading-relaxed">Specific audience. Observable problem. Schedulable action. Clear channel. This system is structured and testable. Do not expand scope before running it.</p>
          <p class="text-muted text-xs mt-2 font-medium">Action: Move to the next step and run this trigger for 7 days.</p>
         </div>
        </div>
       </div>
      </div>
     </div><button onclick="goToScreen(2)" class="btn-primary w-full bg-navy text-white font-medium py-4 rounded-xl hover:bg-navyLight"> Continue to Operational Steps </button>
    </div><!-- Screen 2: Operational Steps -->
    <div id="screen-2" class="screen hidden">
     <div class="mb-6">
      <div class="flex items-center gap-2 mb-2"><span class="w-8 h-8 rounded-full bg-navy text-white flex items-center justify-center text-sm font-semibold">O</span>
       <h2 class="font-serif text-2xl font-bold text-text">Map the Steps</h2>
      </div>
      <p class="text-muted text-base leading-relaxed">What happens every single time after someone says, "I'm interested"?</p>
     </div>
     <div class="bg-card rounded-xl shadow-sm border border-border p-5 mb-6">
      <div class="space-y-4">
       <div><label class="block text-sm font-medium text-text mb-1.5">Step 1</label> <input type="text" id="op-step-1" class="input-field w-full px-4 py-3 border border-border rounded-lg text-text placeholder-slate" placeholder="e.g., Send a DM with calendar link">
       </div>
       <div><label class="block text-sm font-medium text-text mb-1.5">Step 2</label> <input type="text" id="op-step-2" class="input-field w-full px-4 py-3 border border-border rounded-lg text-text placeholder-slate" placeholder="e.g., Follow up after 24 hours if no response">
       </div>
       <div><label class="block text-sm font-medium text-text mb-1.5">Step 3</label> <input type="text" id="op-step-3" class="input-field w-full px-4 py-3 border border-border rounded-lg text-text placeholder-slate" placeholder="e.g., Confirm call 1 hour before">
       </div>
       <div><label class="block text-sm font-medium text-text mb-1.5">Step 4</label> <input type="text" id="op-step-4" class="input-field w-full px-4 py-3 border border-border rounded-lg text-text placeholder-slate" placeholder="e.g., Send recap email within 24 hours">
       </div>
      </div>
     </div>
     <div class="mb-6">
      <p class="text-sm font-medium text-muted mb-3 uppercase tracking-wide">Feedback Status</p>
      <div class="grid gap-3">
       <div class="feedback-card cursor-pointer bg-card border-2 border-border rounded-xl p-4 hover:border-caution" data-feedback="2-1" onclick="selectFeedback('2-1')">
        <div class="flex items-start gap-3">
         <div class="w-3 h-3 rounded-full bg-caution mt-1 flex-shrink-0"></div>
         <div>
          <p class="font-medium text-text text-sm">Needs Structure</p>
          <p class="text-muted text-sm mt-1">Steps are out of order or incomplete. Every lead must move forward without confusion.</p>
         </div>
        </div>
       </div>
       <div class="feedback-card cursor-pointer bg-card border-2 border-border rounded-xl p-4 hover:border-warning" data-feedback="2-2" onclick="selectFeedback('2-2')">
        <div class="flex items-start gap-3">
         <div class="w-3 h-3 rounded-full bg-warning mt-1 flex-shrink-0"></div>
         <div>
          <p class="font-medium text-text text-sm">Clear Sequence</p>
          <p class="text-muted text-sm mt-1">The steps flow logically. Now remove unnecessary friction.</p>
         </div>
        </div>
       </div>
       <div class="feedback-card cursor-pointer bg-card border-2 border-border rounded-xl p-4 hover:border-success" data-feedback="2-3" onclick="selectFeedback('2-3')">
        <div class="flex items-start gap-3">
         <div class="w-3 h-3 rounded-full bg-success mt-1 flex-shrink-0"></div>
         <div>
          <p class="font-medium text-text text-sm">System Ready</p>
          <p class="text-muted text-sm mt-1">This sequence can run consistently without relying on memory.</p>
         </div>
        </div>
       </div>
      </div>
     </div>
     <div class="flex gap-3"><button onclick="goToScreen(1)" class="flex-1 bg-white border border-border text-text font-medium py-4 rounded-xl hover:bg-gray-50"> Back </button> <button onclick="goToScreen(3)" class="flex-1 btn-primary bg-navy text-white font-medium py-4 rounded-xl hover:bg-navyLight"> Continue to Ownership </button>
     </div>
    </div><!-- Screen 3: Ownership -->
    <div id="screen-3" class="screen hidden">
     <div class="mb-6">
      <div class="flex items-center gap-2 mb-2"><span class="w-8 h-8 rounded-full bg-navy text-white flex items-center justify-center text-sm font-semibold">O</span>
       <h2 class="font-serif text-2xl font-bold text-text">Assign Ownership</h2>
      </div>
      <p class="text-muted text-base leading-relaxed">Who performs each step?</p>
     </div>
     <div class="bg-card rounded-xl shadow-sm border border-border p-5 mb-6">
      <div class="space-y-4">
       <div class="flex items-center justify-between gap-4 p-3 bg-surface rounded-lg">
        <div class="flex-1 min-w-0">
         <p class="text-sm font-medium text-text">Step 1</p>
         <p id="owner-step-1-text" class="text-sm text-muted truncate">Send a DM with calendar link</p>
        </div><select id="owner-step-1" class="input-field px-3 py-2 border border-border rounded-lg text-sm text-text bg-white min-w-[120px]"> <option value="human">Human</option> <option value="ai">AI</option> <option value="automation">Automation</option> <option value="hybrid">Hybrid</option> </select>
       </div>
       <div class="flex items-center justify-between gap-4 p-3 bg-surface rounded-lg">
        <div class="flex-1 min-w-0">
         <p class="text-sm font-medium text-text">Step 2</p>
         <p id="owner-step-2-text" class="text-sm text-muted truncate">Follow up after 24 hours</p>
        </div><select id="owner-step-2" class="input-field px-3 py-2 border border-border rounded-lg text-sm text-text bg-white min-w-[120px]"> <option value="human">Human</option> <option value="ai">AI</option> <option value="automation">Automation</option> <option value="hybrid">Hybrid</option> </select>
       </div>
       <div class="flex items-center justify-between gap-4 p-3 bg-surface rounded-lg">
        <div class="flex-1 min-w-0">
         <p class="text-sm font-medium text-text">Step 3</p>
         <p id="owner-step-3-text" class="text-sm text-muted truncate">Confirm call 1 hour before</p>
        </div><select id="owner-step-3" class="input-field px-3 py-2 border border-border rounded-lg text-sm text-text bg-white min-w-[120px]"> <option value="human">Human</option> <option value="ai">AI</option> <option value="automation">Automation</option> <option value="hybrid">Hybrid</option> </select>
       </div>
       <div class="flex items-center justify-between gap-4 p-3 bg-surface rounded-lg">
        <div class="flex-1 min-w-0">
         <p class="text-sm font-medium text-text">Step 4</p>
         <p id="owner-step-4-text" class="text-sm text-muted truncate">Send recap email within 24 hours</p>
        </div><select id="owner-step-4" class="input-field px-3 py-2 border border-border rounded-lg text-sm text-text bg-white min-w-[120px]"> <option value="human">Human</option> <option value="ai">AI</option> <option value="automation">Automation</option> <option value="hybrid">Hybrid</option> </select>
       </div>
      </div>
     </div>
     <div class="mb-6">
      <p class="text-sm font-medium text-muted mb-3 uppercase tracking-wide">Feedback Status</p>
      <div class="grid gap-3">
       <div class="feedback-card cursor-pointer bg-card border-2 border-border rounded-xl p-4 hover:border-caution" data-feedback="3-1" onclick="selectFeedback('3-1')">
        <div class="flex items-start gap-3">
         <div class="w-3 h-3 rounded-full bg-caution mt-1 flex-shrink-0"></div>
         <div>
          <p class="font-medium text-text text-sm">Overloaded Founder</p>
          <p class="text-muted text-sm mt-1">You are performing every step manually. Identify at least one delegation opportunity.</p>
         </div>
        </div>
       </div>
       <div class="feedback-card cursor-pointer bg-card border-2 border-border rounded-xl p-4 hover:border-warning" data-feedback="3-2" onclick="selectFeedback('3-2')">
        <div class="flex items-start gap-3">
         <div class="w-3 h-3 rounded-full bg-warning mt-1 flex-shrink-0"></div>
         <div>
          <p class="font-medium text-text text-sm">Balanced</p>
          <p class="text-muted text-sm mt-1">You have identified automation opportunities, but follow-up timing may still rely on you.</p>
         </div>
        </div>
       </div>
       <div class="feedback-card cursor-pointer bg-card border-2 border-border rounded-xl p-4 hover:border-success" data-feedback="3-3" onclick="selectFeedback('3-3')">
        <div class="flex items-start gap-3">
         <div class="w-3 h-3 rounded-full bg-success mt-1 flex-shrink-0"></div>
         <div>
          <p class="font-medium text-text text-sm">Leveraged</p>
          <p class="text-muted text-sm mt-1">Clear division of responsibility. The system does not depend entirely on you.</p>
         </div>
        </div>
       </div>
      </div>
     </div>
     <div class="flex gap-3"><button onclick="goToScreen(2)" class="flex-1 bg-white border border-border text-text font-medium py-4 rounded-xl hover:bg-gray-50"> Back </button> <button onclick="goToScreen(4)" class="flex-1 btn-primary bg-navy text-white font-medium py-4 rounded-xl hover:bg-navyLight"> Continue to Proof </button>
     </div>
    </div><!-- Screen 4: Proof -->
    <div id="screen-4" class="screen hidden">
     <div class="mb-6">
      <div class="flex items-center gap-2 mb-2"><span class="w-8 h-8 rounded-full bg-navy text-white flex items-center justify-center text-sm font-semibold">P</span>
       <h2 class="font-serif text-2xl font-bold text-text">Define Proof</h2>
      </div>
      <p class="text-muted text-base leading-relaxed">How will you measure success in the next 30 days?</p>
     </div>
     <div class="bg-card rounded-xl shadow-sm border border-border p-5 mb-6">
      <div class="space-y-4">
       <div><label class="block text-sm font-medium text-text mb-1.5">Target metric</label> <input type="text" id="proof-metric" class="input-field w-full px-4 py-3 border border-border rounded-lg text-text placeholder-slate" placeholder="e.g., 10 booked calls">
       </div>
       <div><label class="block text-sm font-medium text-text mb-1.5">Timeframe</label> <select id="proof-timeframe" class="input-field w-full px-4 py-3 border border-border rounded-lg text-text bg-white"> <option value="">Select timeframe</option> <option value="7">7 days</option> <option value="14">14 days</option> <option value="30">30 days</option> <option value="60">60 days</option> </select>
       </div>
       <div><label class="block text-sm font-medium text-text mb-1.5">Tracking method</label> <select id="proof-tracking" class="input-field w-full px-4 py-3 border border-border rounded-lg text-text bg-white"> <option value="">Select method</option> <option value="sheet">Google Sheet</option> <option value="crm">CRM</option> <option value="manual">Manual log</option> <option value="notion">Notion</option> </select>
       </div>
      </div>
     </div>
     <div class="mb-6">
      <p class="text-sm font-medium text-muted mb-3 uppercase tracking-wide">Feedback Status</p>
      <div class="grid gap-3">
       <div class="feedback-card cursor-pointer bg-card border-2 border-border rounded-xl p-4 hover:border-caution" data-feedback="4-1" onclick="selectFeedback('4-1')">
        <div class="flex items-start gap-3">
         <div class="w-3 h-3 rounded-full bg-caution mt-1 flex-shrink-0"></div>
         <div>
          <p class="font-medium text-text text-sm">Too Vague</p>
          <p class="text-muted text-sm mt-1">"More leads" is not measurable. Use a number and a deadline.</p>
         </div>
        </div>
       </div>
       <div class="feedback-card cursor-pointer bg-card border-2 border-border rounded-xl p-4 hover:border-warning" data-feedback="4-2" onclick="selectFeedback('4-2')">
        <div class="flex items-start gap-3">
         <div class="w-3 h-3 rounded-full bg-warning mt-1 flex-shrink-0"></div>
         <div>
          <p class="font-medium text-text text-sm">Defined</p>
          <p class="text-muted text-sm mt-1">The metric is numeric but may not reflect revenue.</p>
         </div>
        </div>
       </div>
       <div class="feedback-card cursor-pointer bg-card border-2 border-border rounded-xl p-4 hover:border-success" data-feedback="4-3" onclick="selectFeedback('4-3')">
        <div class="flex items-start gap-3">
         <div class="w-3 h-3 rounded-full bg-success mt-1 flex-shrink-0"></div>
         <div>
          <p class="font-medium text-text text-sm">Outcome-Focused</p>
          <p class="text-muted text-sm mt-1">This metric directly ties to conversations or revenue.</p>
         </div>
        </div>
       </div>
      </div>
     </div>
     <div class="flex gap-3"><button onclick="goToScreen(3)" class="flex-1 bg-white border border-border text-text font-medium py-4 rounded-xl hover:bg-gray-50"> Back </button> <button onclick="goToScreen(5)" class="flex-1 btn-primary bg-navy text-white font-medium py-4 rounded-xl hover:bg-navyLight"> View Summary </button>
     </div>
    </div><!-- Screen 5: Summary -->
    <div id="screen-5" class="screen hidden">
     <div class="mb-6">
      <div class="flex items-center gap-2 mb-2"><span class="w-8 h-8 rounded-full bg-success text-white flex items-center justify-center">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
        </svg></span>
       <h2 class="font-serif text-2xl font-bold text-text">Your LOOP System</h2>
      </div>
      <p class="text-muted text-base leading-relaxed">Here's your complete lead-to-conversation system.</p>
     </div><!-- Lead Trigger Summary -->
     <div class="bg-card rounded-xl shadow-sm border border-border p-5 mb-4">
      <div class="flex items-center gap-2 mb-4"><span class="w-6 h-6 rounded-full bg-navy text-white flex items-center justify-center text-xs font-semibold">L</span>
       <h3 class="font-semibold text-text">Lead Trigger</h3>
      </div>
      <div class="space-y-3 text-sm">
       <div class="flex justify-between items-start gap-4"><span class="text-muted flex-shrink-0">Audience</span> <span id="summary-audience" class="text-text text-right font-medium">—</span>
       </div>
       <div class="flex justify-between items-start gap-4"><span class="text-muted flex-shrink-0">Problem</span> <span id="summary-problem" class="text-text text-right font-medium">—</span>
       </div>
       <div class="flex justify-between items-start gap-4"><span class="text-muted flex-shrink-0">Call to Action</span> <span id="summary-cta" class="text-text text-right font-medium">—</span>
       </div>
       <div class="flex justify-between items-start gap-4"><span class="text-muted flex-shrink-0">Channel</span> <span id="summary-channel" class="text-text text-right font-medium">—</span>
       </div>
      </div>
     </div><!-- Operational Steps Summary -->
     <div class="bg-card rounded-xl shadow-sm border border-border p-5 mb-4">
      <div class="flex items-center gap-2 mb-4"><span class="w-6 h-6 rounded-full bg-navy text-white flex items-center justify-center text-xs font-semibold">O</span>
       <h3 class="font-semibold text-text">Operational Steps &amp; Ownership</h3>
      </div>
      <div class="space-y-3 text-sm">
       <div class="flex justify-between items-start gap-4 p-2 bg-surface rounded-lg">
        <div class="flex gap-2 items-start flex-1 min-w-0"><span class="text-muted flex-shrink-0">1.</span> <span id="summary-step-1" class="text-text font-medium">—</span>
        </div><span id="summary-owner-1" class="text-xs px-2 py-1 bg-navy text-white rounded-full flex-shrink-0">Human</span>
       </div>
       <div class="flex justify-between items-start gap-4 p-2 bg-surface rounded-lg">
        <div class="flex gap-2 items-start flex-1 min-w-0"><span class="text-muted flex-shrink-0">2.</span> <span id="summary-step-2" class="text-text font-medium">—</span>
        </div><span id="summary-owner-2" class="text-xs px-2 py-1 bg-navy text-white rounded-full flex-shrink-0">Human</span>
       </div>
       <div class="flex justify-between items-start gap-4 p-2 bg-surface rounded-lg">
        <div class="flex gap-2 items-start flex-1 min-w-0"><span class="text-muted flex-shrink-0">3.</span> <span id="summary-step-3" class="text-text font-medium">—</span>
        </div><span id="summary-owner-3" class="text-xs px-2 py-1 bg-navy text-white rounded-full flex-shrink-0">Human</span>
       </div>
       <div class="flex justify-between items-start gap-4 p-2 bg-surface rounded-lg">
        <div class="flex gap-2 items-start flex-1 min-w-0"><span class="text-muted flex-shrink-0">4.</span> <span id="summary-step-4" class="text-text font-medium">—</span>
        </div><span id="summary-owner-4" class="text-xs px-2 py-1 bg-navy text-white rounded-full flex-shrink-0">Human</span>
       </div>
      </div>
     </div><!-- Proof Summary -->
     <div class="bg-card rounded-xl shadow-sm border border-border p-5 mb-6">
      <div class="flex items-center gap-2 mb-4"><span class="w-6 h-6 rounded-full bg-navy text-white flex items-center justify-center text-xs font-semibold">P</span>
       <h3 class="font-semibold text-text">Proof</h3>
      </div>
      <div class="space-y-3 text-sm">
       <div class="flex justify-between items-start gap-4"><span class="text-muted flex-shrink-0">Target</span> <span id="summary-metric" class="text-text text-right font-medium">—</span>
       </div>
       <div class="flex justify-between items-start gap-4"><span class="text-muted flex-shrink-0">Timeframe</span> <span id="summary-timeframe" class="text-text text-right font-medium">—</span>
       </div>
       <div class="flex justify-between items-start gap-4"><span class="text-muted flex-shrink-0">Tracking</span> <span id="summary-tracking" class="text-text text-right font-medium">—</span>
       </div>
      </div>
     </div>
     <div class="flex gap-3 mb-6"><button onclick="goToScreen(4)" class="flex-1 bg-white border border-border text-text font-medium py-4 rounded-xl hover:bg-gray-50"> Back </button> <button onclick="downloadSummary()" class="flex-1 btn-primary bg-success text-white font-medium py-4 rounded-xl hover:opacity-90 flex items-center justify-center gap-2">
       <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
       </svg> Download Your LOOP Summary </button>
     </div><button onclick="goToScreen(1)" class="w-full bg-white border border-border text-navy font-medium py-3 rounded-xl hover:bg-gray-50 mb-6"> Refine My LOOP </button>
     <div class="bg-surface rounded-lg p-4 text-center border border-border">
      <p class="text-sm text-muted">This system improves each time it runs. Review weekly.</p>
     </div>
    </div>
   </main>
  </div>
  <script>
    // Default configuration
    const defaultConfig = {
      main_title: 'The LOOP Builder',
      subtitle: 'Build your first working business system.'
    };

    let currentScreen = 1;
    const selectedFeedback = {};

    // Initialize Element SDK
    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange: async (config) => {
          const title = document.getElementById('main-title');
          const subtitle = document.getElementById('subtitle');
          if (title) title.textContent = config.main_title || defaultConfig.main_title;
          if (subtitle) subtitle.textContent = config.subtitle || defaultConfig.subtitle;
        },
        mapToCapabilities: (config) => ({
          recolorables: [],
          borderables: [],
          fontEditable: undefined,
          fontSizeable: undefined
        }),
        mapToEditPanelValues: (config) => new Map([
          ['main_title', config.main_title || defaultConfig.main_title],
          ['subtitle', config.subtitle || defaultConfig.subtitle]
        ])
      });
    }

    function updateClarityScore() {
      const checks = [
        document.getElementById('check-1-1')?.checked || false,
        document.getElementById('check-1-2')?.checked || false,
        document.getElementById('check-1-3')?.checked || false,
        document.getElementById('check-1-4')?.checked || false
      ];
      const score = checks.filter(c => c).length;
      const percent = (score / 4) * 100;
      
      document.getElementById('clarity-score-1').textContent = `${score}/4`;
      const bar = document.getElementById('clarity-bar-1');
      bar.style.width = `${percent}%`;
      
      // Change color based on score
      if (score <= 1) {
        bar.classList.remove('bg-warning', 'bg-success');
        bar.classList.add('bg-caution');
      } else if (score <= 3) {
        bar.classList.remove('bg-caution', 'bg-success');
        bar.classList.add('bg-warning');
      } else {
        bar.classList.remove('bg-caution', 'bg-warning');
        bar.classList.add('bg-success');
      }
    }

    // Attach checklist listeners on page load
    document.addEventListener('DOMContentLoaded', () => {
      for (let i = 1; i <= 4; i++) {
        const check = document.getElementById(`check-1-${i}`);
        if (check) {
          check.addEventListener('change', updateClarityScore);
        }
      }
    });

    function goToScreen(screen) {
      // Update ownership step text when going to screen 3
      if (screen === 3) {
        updateOwnershipStepText();
      }
      
      // Update summary when going to screen 5
      if (screen === 5) {
        updateSummary();
      }

      // Hide all screens
      for (let i = 1; i <= 5; i++) {
        document.getElementById(`screen-${i}`).classList.add('hidden');
      }
      
      // Show target screen
      document.getElementById(`screen-${screen}`).classList.remove('hidden');
      
      // Update progress
      for (let i = 1; i <= 5; i++) {
        const bar = document.getElementById(`progress-${i}`);
        if (i <= screen) {
          bar.classList.remove('bg-border');
          bar.classList.add('bg-navy');
        } else {
          bar.classList.remove('bg-navy');
          bar.classList.add('bg-border');
        }
      }
      
      // Update step label
      document.getElementById('step-label').textContent = `Step ${screen} of 5`;
      
      currentScreen = screen;
      
      // Scroll to top
      document.getElementById('app').scrollTo({ top: 0, behavior: 'smooth' });
    }

    function selectFeedback(id) {
      const screenId = id.split('-')[0];
      
      // Deselect all feedback cards in this screen
      document.querySelectorAll(`[data-feedback^="${screenId}-"]`).forEach(card => {
        card.classList.remove('selected', 'border-caution', 'border-warning', 'border-success');
        card.classList.add('border-border');
      });
      
      // Select the clicked card
      const card = document.querySelector(`[data-feedback="${id}"]`);
      card.classList.remove('border-border');
      card.classList.add('selected');
      
      // Add appropriate border color
      if (id.endsWith('-1')) card.classList.add('border-caution');
      else if (id.endsWith('-2')) card.classList.add('border-warning');
      else if (id.endsWith('-3')) card.classList.add('border-success');
      
      selectedFeedback[screenId] = id;
    }

    function updateOwnershipStepText() {
      const steps = ['op-step-1', 'op-step-2', 'op-step-3', 'op-step-4'];
      const targets = ['owner-step-1-text', 'owner-step-2-text', 'owner-step-3-text', 'owner-step-4-text'];
      
      steps.forEach((stepId, index) => {
        const value = document.getElementById(stepId).value;
        const target = document.getElementById(targets[index]);
        if (value) {
          target.textContent = value;
        }
      });
    }

    function updateSummary() {
      // Lead Trigger
      const audience = document.getElementById('lead-audience').value || '—';
      const problem = document.getElementById('lead-problem').value || '—';
      const cta = document.getElementById('lead-cta').value || '—';
      const channelSelect = document.getElementById('lead-channel');
      const channel = channelSelect.options[channelSelect.selectedIndex]?.text || '—';
      
      document.getElementById('summary-audience').textContent = audience;
      document.getElementById('summary-problem').textContent = problem;
      document.getElementById('summary-cta').textContent = cta;
      document.getElementById('summary-channel').textContent = channel !== 'Select a channel' ? channel : '—';
      
      // Operational Steps
      for (let i = 1; i <= 4; i++) {
        const step = document.getElementById(`op-step-${i}`).value || '—';
        document.getElementById(`summary-step-${i}`).textContent = step;
        
        const ownerSelect = document.getElementById(`owner-step-${i}`);
        const owner = ownerSelect.options[ownerSelect.selectedIndex]?.text || 'Human';
        document.getElementById(`summary-owner-${i}`).textContent = owner;
      }
      
      // Proof
      const metric = document.getElementById('proof-metric').value || '—';
      const timeframeSelect = document.getElementById('proof-timeframe');
      const timeframe = timeframeSelect.value ? `${timeframeSelect.value} days` : '—';
      const trackingSelect = document.getElementById('proof-tracking');
      const tracking = trackingSelect.options[trackingSelect.selectedIndex]?.text || '—';
      
      document.getElementById('summary-metric').textContent = metric;
      document.getElementById('summary-timeframe').textContent = timeframe;
      document.getElementById('summary-tracking').textContent = tracking !== 'Select method' ? tracking : '—';
    }

    function downloadSummary() {
      const audience = document.getElementById('summary-audience').textContent;
      const problem = document.getElementById('summary-problem').textContent;
      const cta = document.getElementById('summary-cta').textContent;
      const channel = document.getElementById('summary-channel').textContent;
      
      let summary = `THE LOOP SYSTEM SUMMARY
========================

LEAD TRIGGER (L)
----------------
Audience: ${audience}
Problem: ${problem}
Call to Action: ${cta}
Channel: ${channel}

OPERATIONAL STEPS (O)
---------------------`;

      for (let i = 1; i <= 4; i++) {
        const step = document.getElementById(`summary-step-${i}`).textContent;
        const owner = document.getElementById(`summary-owner-${i}`).textContent;
        summary += `\n${i}. ${step} [${owner}]`;
      }

      const metric = document.getElementById('summary-metric').textContent;
      const timeframe = document.getElementById('summary-timeframe').textContent;
      const tracking = document.getElementById('summary-tracking').textContent;

      summary += `

PROOF (P)
---------
Target: ${metric}
Timeframe: ${timeframe}
Tracking: ${tracking}

========================
Generated by The LOOP Builder`;

      const blob = new Blob([summary], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'LOOP-System-Summary.txt';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9d303d29a0b4675a',t:'MTc3MTk0OTQ4Ny4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
